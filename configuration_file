#Author: Nikolaos M.R. Lykoskoufis
#8th of July 2021
#Default configuration for the rnaseq pipeline 

#This file is a comma separated value file, lines starting with "#" are comments not readed by the pipeline.
#Fist words are key words that must not be changed.

#Email of the data managers
#This option is a list of email to which report will be sent during the data processing
#The reports are sent at different steps of the pipeline and keep user informed of the processus
contact_email,nikolaos.lykoskoufis@unige.ch 






#Are reads Pair-end read: 1 if they are pair-end, 0 if they are single-end
pairend,1

#Information about lane to process
lanes,1,2,3,4,5,6,7,8

#Options for demultiplexing (check Illumina CASAVA documentation for more information): 
#Number of mismatches allowed in indexe for demultiplexing (0 or 1)
mismatches,1

#Mask: Y50 I6n y50 --> Read it this way: Y50 'Y' mean first read, 50 give the size: I7 'I' mean index, 6 give the size and n signify that one base is not used: y50 'y' mean second read, 50 give the size
#This option can be useful to specify wich part of the sequences should be used during the demultiplexing
qseq-mask,y50 I6 y50

#reference genome used to map reads (could be a directory path for STAR or the index file prefix for GEM, BWA or bowtie)
ref_genome_name,/data/unige/funpopgen/2backup/common/data/indexes/gem_indexes/hg19_chr_only_and_herpes_index/hg19_chr_only_and_herpes.gem

#Choose your mapper (possible options: bwa, bowtie, GEM, STAR)
mapper,STAR

#Modify the BWA options. 
#bwa aln,               #modify bwa option for alignement. Default options: "-t 6"
#bwa sampe,-a,500000    #mendatory if you want to map pairend-end. If you want to modify the options put something after the ",". Default options: none
#bwa samse,-a,500000    #mendatory if you want to map single-end. If you want to modify the options put something after the ",". Default options: none

#Modify the bowtie options. Default options: "-S -p 8"
#bowtie,

#Modify the GEM options. The default options: "rna-pipeline -t 8 -q 33 --direct-input --compact"
#GEMoption,-q 33,-t 6,--direct-input,--compact,--no-stats,--no-filtered,--no-count

#Modify the STAR options. The default ones are "--readFilesCommand zcat --runThreadN 8 --outSAMtype BAM SortedByCoordinate --outSJfilterReads Unique --twopassMode Basic --outSAMmultNmax 1 --outSAMattributes All". --outSAMmultNmax 1 will output only 1 alignment per read and report the number of hits with the tag NH:i:x but the mapping position of these multiple hits will not be reported. If you remove the "--outSAMmultNmax 1" option then some stats reported by the pipeline will be wrong (such as the number of reads). --outSAMattributes All will output all tags. There was a problem with the previous version of the pipeline. STAR by default does not output NM which was a problem since this tag is NEEDED for the proper filtering of the number of mismatches when running quantifications.
STARoption,--readFilesCommand zcat --runThreadN 8 --outSAMtype BAM SortedByCoordinate --outSJfilterReads Unique --twopassMode Basic --outSAMmultNmax 1 --outSAMunmapped Within --outSAMattributes All

#Maximum read length in fastq (Mendatory line for star. Will set the --sjdbOverhang option to STARreadLength - 1)
STARreadLength,50

#If uncommented keep all GEM results in a directory in destination/bam/gem
#keep_all_GEM
#If uncommented keep all STAR results destination/bam/star
keep_all_STAR

#Set mapping bsub option, if you modify this make sur you allocat correctly enough nodes, memory so nothing crash on vital-it.
#WARNING : values set as example are not good to use, If you are not sure please leave this options commented and good default values will be used by the pipeline.
# Default for GEM: -q normal -M 70000000 -R "span[hosts=1]" -R "rusage[mem=70000]" -n8
# Default for STAR: -q normal -M 60000000 -R "span[hosts=1]" -R "rusage[mem=60000]" -n 8
# Default for BWA: -q normal -M 5000000 -R "rusage[mem=5000]" -n 6
# Default for Bowtie: -q normal -M 20000000 -R "rusage[mem=15000]" -n 8
#mapping_bsub_option,-M 60000000 -R rusage[mem=60000] -R span[hosts=1] -n 16 -q normal

#Annotation file use for exon quantification
quantification_annotation,/data/unige/funpopgen/2backup/common/data/annotation/gencode_v26/gencode.v26.annotation.filtered.gtf

#Annotation files use by GEM for transcriptom mapping
#GEM_annotation,/data/unige/funpopgen/2backup/common/data/indexes/gem_indexes/transcriptome_gencode.v19_index/gencode.v19.annotation.gtf

#Annotation files use by STAR for transcripto
STAR_annotation,/data/unige/funpopgen/2backup/common/data/annotation/gencode_v26/gencode.v26.annotation.filtered.gtf

#Give a mapping quality score threshold to select mapped reads for the quantification step only (if not set quality_score_threshold = 10. We usually use, 10 for BWA, 150 for GEM and 255 for STAR)
quality_score_threshold,255

#Annotation, mismatches threshold for reads, check NM:i: flag in bam file. Usefull only for the quantification step. Will allow NM_threshold in the read for single end or in both reads together for paired-ends
NM_threshold,8

#required option for qc_fastq
qc_fastq,all

#Run annotation (used only with task 1 and 3)
run_annotation,1

#Draw graphs for fastq qc (0=no, 1=yes)
fastq_qc_graphs,1

##Draw graphs for mapping qc (0=no, 1=yes)
mapping_qc_graphs,1

#######################################################################################################
#                                         SOFTWARE PATH                                               #
#######################################################################################################
#This part, in coma separated value format, is used by main.py to set executable directory
#In each lane, the first word is a keyword that should not be changed, the second part after
#the comma is the path to the corresponding executable.

#path to python 3.2
python,/home/ipadiole/bin/python3.2

#Path to setupBclToFastq
setupBclToFastq,/software/UHTS/Analysis/bcl2fastq/2.19.0/bin/bcl2fastq

#Path to bwa
bwa,/data/unige/funpopgen/2backup/common/tools/src/bwa/bwa-0.7.10/bwa-0.7.10/bwa

#Path to bowtie
bowtie_dir,/mnt/common/UHTS/beta/Linux/x86_64/Bowtie/bowtie-0.12.7/bowtie

#Path to GEM
gem,/home/npanousi/src/gemtools-1.7.1-core2/bin/gemtools

#Path to STAR
star,/software/UHTS/Aligner/STAR/2.5.3a/bin/STAR

#Path to samtools
samtools,/software/UHTS/Analysis/samtools/1.3/bin/samtools

#bamToFastq
bamToFastq,/data/unige/funpopgen/2backup/common/tools/src/Hydra-Version-0.5.3/bin/bamToFastq

#Rscript
Rscript,/software/R/3.4.2/bin/Rscript

#Quantification script (use QTLtools or the old script: samtoexoncoverage_gencode.pl)
Quantification,/data/unige/funpopgen/chowald/scripts/tools/softwares/QTLtools/QTLtools-master_03.10.2017/qtltools/bin/QTLtools

#### NEEED TO UPDATE QTLTOOLS VERSION.

#Quantification,/data/unige/funpopgen/2backup/common/tools/src/RNAseq_pipeline_v4/pipeline/RNAseq_pipeline_v4/trunk/dquantification/samtoexoncoverage_gencode.pl

#######################################################################
#                             BACKUP PATH                             #
#######################################################################
#Directory where an archive containing fastq and bam will be copied
backup_root,/data/unige/funpopgen/2backup/common/data/sequencing_data/
